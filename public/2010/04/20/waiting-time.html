<!DOCTYPE html>
<html lang="en" xmlns="https://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: https://purl.org/dc/terms/ og: https://ogp.me/ns#"> <!-- namespaces used in metadata.html -->
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
  <title>Waiting Time</title>
  <meta name="author" content="Carl Boettiger" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- HTML5 metadata -->
<meta name="keywords" content="adaptive-dynamics" />
<meta name="description" content="" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Waiting Time" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2010-04-20 00:00:00 +0000" />
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:identifier" content="/04/20/waiting-time.html" />
<meta property="dc:rights" content="CC0" />
<meta property="dc:source" content="Lab Notebook" />
<meta property="dc:subject" content="Ecology" /> 
<meta property="dc:type" content="website" /> 
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Waiting Time" />
<meta property="og:author" content="https://www.carlboettiger.info/index.html#me" />  <!-- Should be Liquid? URI? -->
<meta property="https://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="https://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="https://ogp.me/ns/article#published_time" content="2010-04-20 00:00:00 +0000" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="https://www.carlboettiger.info/04/20/waiting-time.html" />
<meta property="og:type" content="website" /> 
<!-- Google Scholar Metadata -->
<!--
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_date" content="2010-04-20 00:00:00 +0000"/>
<meta name="citation_title" content="Waiting Time"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
-->
<!--NOTE: see also the COinS Metadata in span element in footer -->




	<link href="https://www.carlboettiger.info/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <!-- Help the browser identify the RSS feed automatically -->
  <link rel="alternate" type="application/rss+xml" title="Carl Boettiger's Lab Notebook" href="/blog.xml" />
</head>


  <body prefix="dc: https://purl.org/dc/terms/ foaf: https://xmlns.com/foaf/0.1/"> 
    <!-- Navbar  ================================================== -->

<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/README.html"><i class="icon-info-sign"></i></a>
    </div>

 <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

          <li  >
          <a href="/index.html">Home</a></li>
          <li  >
          <a href="/vita.html">Vita</a></li>
          <li  >
          <a href="/research.html">Research</a></li>
          <li  >
          <a href="/teaching.html">Teaching</a></li>
          <li  >
          <a href="/community.html">Community</a></li>
          <li  >
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>

      <!-- Search site using Google's index -->
        <form class="navbar-form navbar-right" role="search" method="get" action="https://google.com/search">
          <div class="form-group">
            <input type="hidden" name="q" value="site:carlboettiger.info" />
            <input type="text" class="form-control search-query" name="q" placeholder="Search"/>
          </div>
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
       </form>

    </div><!--/.nav-collapse -->
  </div> <!-- /container -->
</nav>



    <div class="container"> <!-- Responsive grid layout, doesn't jump to full-width --> 
      <header>
        <h1 class="entry-title">Waiting Time</h1>
        <h2></h2>
      </header>

      <div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <p><strong>editorial note</strong>: These notes pre-date the formal start of my online laboratory notebook, <a href="https://carlboettiger.info/2010/02/02/The-Lab-Notebook-Goes-Open-.html">Feb 2 2010: The Lab Notebook Goes Open</a> and were adapted from a LaTeX document in which I kept notes on this topic during my summer at <a href="https://www.iiasa.ac.at/">IIASA</a>. Lacking a proper notebook then, documents like this one were updated periodically and occassionally branched into new ones. The post date represents the last time the LaTeX document was edited in the course of that research.</p>
<hr />
<h1 id="abstract">Abstract</h1>
<p>The theory of Adaptive Dynamics has recieved much attention for its analysis of evolutionary branching points. While the asymptotic dynamics of such branching points has been well studied, little is known about the timescale of the process or its behaviour away from the asymptotic limits of large populations and rare, small mutational steps. We provide several estimates of the waiting time for evolutionary branching to occur when different assumptions are relaxed. This approach demonstrates how adaptive branching can be characterized by four seperate phases and also identifies the most likely rate-limiting process in the course of adaptive branching. Our analytic approximations are compared to exact numerical simulation of the branching process.</p>
<h1 id="introduction">Introduction</h1>
<p>In adaptive dynamics theory, an evolutionary branching point is a singular strategy that is globally convergent but locally unstable.</p>
<p>A population approaches by discrete jumps.</p>
<p>Almost all quantitative theories of evolution have relied on stochastic models to address the impacts of chance events - such as mutations, births, deaths, and environmental changes - that affect the evolutionary process (Fisher 1937; Lande 1979; Coyne &amp; Orr 2004). Adaptive dynamics theory typically considers two sources of stochasticity: random mutations and the loss of advantageous mutants to chance extinction while their numbers are small. What these models typically do not consider is demographic stochasticity of resident populations (resulting from intrinsic fluctuations through stochastic birth and death events in finite populations of discrete individuals) and environmental stochasticity (resulting from external fluctuations in the environmental conditions a population experiences).</p>
<p>Several recent studies have tried to overcome these limitations. Claessen et al. (2007, 2008) explore simulations of evolutionary branching in small populations and found that demographic stochasticity can delay or halt diversification. Johansson and Ripa (2006) explored the impact that correlated environmental stochasticity has on diversification. They assume that as populations diverge, the environmental influences upon them become less similar. They demonstrate that this correlation can facilitate coexistence early in the process of branching, and as it weakens, the chance that a branch is lost increases. While these studies make an excellent start, a more general theory and mathematical framework is needed to untangle and quantify the multitude of effects stochasticity has on evolutionary branching.</p>
<h1 id="methods">Methods</h1>
<h2 id="model">Model</h2>
<p>We consider the classic adaptive dynamics model for evolutionary branching under competition for a limiting resource by Dieckmann and Doebeli (1999). The population dynamics of <span class="math">\(N(x,t)\)</span> individuals each with focal trait <span class="math">\(x\)</span> are given by a continuous time birth-death process with rates</p>
<p><span class="math">\[\begin{aligned}
b(N) = &amp; r \nonumber \\
d(N) = &amp; r \frac{\sum_yN(y,t)C(x,y)}{K(x)} .\label{general_logistic}\end{aligned}\]</span></p>
<p>The focal trait <span class="math">\(x\)</span> can be thought of as some continuous phenotypic variable, such as beak size, which affects resource consumption. Niche differences driving speciation arise from differences in this trait. In the model, <span class="math">\(K(x)\)</span> is the resource kernel which determines the equilibrium population density and <span class="math">\(C(x,y)\)</span> is a the competition kernel, describing the relative change in death rate of individuals of type <span class="math">\(x\)</span> due to competition by individuals of type <span class="math">\(y\)</span>. Given <span class="math">\(C(x,x)=1\)</span>, the equilibrium density of a monomorphic population is <span class="math">\(N^{\ast}(x)=K(x)\)</span>. Following  we assume the following Gaussian forms,</p>
<p><span class="math">\[K(x)=K_0e^{-x^2/(2\sigma_k^2)}, \label{K}\]</span></p>
<p>and</p>
<p><span class="math">\[C(x,y)=e^{-(x-y)^2/(2\sigma_c^2)}, \label{C}\]</span></p>
<p>where <span class="math">\(\sigma_k\)</span> and <span class="math">\(\sigma_c\)</span> are scale factors for the resource distribution and competition kernels respectively. <span class="math">\(\sigma_c\)</span> can be though of as the niche size. We focus on the case <span class="math">\(\sigma_k&gt;\sigma_c\)</span>, for which the model has an evolutionary branching point at <span class="math">\(x=0\)</span> .</p>
<p>The evolutionary dynamics are specified only at the phenotypic level: We assume that with probability <span class="math">\(\mu\)</span> an individual birth results in a mutant offspring, and that the mutant trait is chosen from a Gaussian distribution centered at the trait value of the parents and with a variance <span class="math">\(\sigma_{\mu}^2\)</span>.</p>
<h2 id="the-adaptive-dynamics-of-branching">The Adaptive Dynamics of Branching</h2>
<p>Evolutionary branching occurs in this model when the resource kernel is wider than the competition kernel, <span class="math">\(\sigma_k &gt; \sigma_c\)</span> as discussed in . It is straight forward to show that the invasion fitness <span class="math">\(s(y,x) := b(K(x),x,y) -d(K(x), x,y)\)</span> of a rare mutant <span class="math">\(y\)</span> in a population <span class="math">\(x\)</span> at equilibrium has a singular point at <span class="math">\(x^*=0\)</span>, the peak of the resource distribution. This is easily confirmed by taking the second derivatives or observing the pairwise invasibility plot.</p>
<h2 id="phases-of-branching">Phases of branching</h2>
<p>Evolutionary branching through this mechanism can be divided into four phases. In the first phase, the population approaches the branching point by repeated invasions that completely replace the monomorphic population. This rate is governed by the canonical equation of adaptive dynamics, a rate proportional to the size of mutational jumps relative to the size of the resource kernel, <span class="math">\(\sigma_{\mu}/\sigma_k\)</span>. Mathematically, this phase can be defined by the <span class="math">\(P_1\)</span> region of the pairwise invasibility plot. In this region, dimoprhisms are always transient.</p>
<p>In the second phase, the population is near enough to the branching point that mutations begin occuring in the coexistence region. More precisely, any dimorphism that occurs in the <span class="math">\(P_2\)</span> region but where one of the populations is too small to contribute to density-dependent effects can be considered to be in this phase. The dynamics of this phase are thus governed by the fixation probabilities of rare mutants occuring in the coexistence region. This phase may often fail when a rare mutant occurs in the coexistence region but is soon lost to drift.</p>
<p>The third phase begins when mutations in the coexistence region survive the initial genetic drift to establish as significant frequencies in the population. In this stage the density-dependent contribution of each population is relevant. This stage may fail due to the loss of either population, more often the one farther from the branching point. As this is usually (but not necessarily) the resident population that gave rise to the other population through mutation, the failure of this phase can be thought of in terms of loss of the resident population, while the second phase is governed primarily by the loss of the invader population.</p>
<p>In the fourth phase, subsequent mutations farther from the branching point invade and the populations move apart. Each time a mutant exterior to the branching point successfully invades the probability the coexistence becomes exponentially more stable, as we will demonstrate. While the expected coexistence time for the two populations remains similar to the evolutionary timescale over which new mutants enter and establish, the coexistence may be lost, collapsing back to the second phase. However, as the coexistence of the first pair (phase 3) is much more likely to collapse than the subsequently more stable coexisting pairs that arise from it, we will have a good approximation by considering only the probabilty that the initial pair survives long enough to enter phase four. This is justified by the Ahrennius approximation result and confirmed by numerical simulation.</p>
<h3 id="overview-of-the-approach">Overview of the approach</h3>
<p>The division into phases provides both a conceptual and mathematical framework to address the branching process. Analyzing the first two phases essentially consists of partitioning the space of possible mutants: considering all the mutants that lie in the <span class="math">\(P_1\)</span> region that are expected to invade and replace the resident (moving the population closer to the branching point as per phase 1), and mutants that reach the coexistence region <span class="math">\(P_2\)</span> in phase 2. This is done by partitioning the domain of integration for an integral over mutant traits <span class="math">\(y\)</span> for each resident <span class="math">\(x\)</span>. The closer <span class="math">\(x\)</span> is to <span class="math">\(x^*\)</span> the more of this integral lies in <span class="math">\(P_2\)</span> and entering phase two becomes increasingly probable. This treatment follows along similar lines as the original derivation of the canonical equation of adaptive dynamics .</p>
<p>The crux of the remaining third and fourth phases settles around predicting the coexistence time. This is done through a diffusion approximation approach to individual dynamics, which remains quite technical to solve. To provide both an effective approximation and a useful intuition, we demonstrate how this coexistence problem can be construed as an escape from a potential energy well, as in classical chemical kinetics. Understanding the depth of this well tells us most of what we need to know about the coexistence time. Relating the coexistence timescale to the evolutionary timescale wraps up the calculation for how long branching will take.</p>
<p>The deterministic theory applies both the limit of rare mutations (small <span class="math">\(\mu\)</span>) and small mutational steps (small <span class="math">\(\sigma_{\mu}\)</span>). In our treatment, either one of these can become the limiting factor and correspond to different regimes of adaptive branching. If mutations are very rare, we’ll see that the population must essentially survive phase 3 in a single mutational step. In this regime recieving a single mutation far enough into the <span class="math">\(P_2\)</span> region to survive the coexistence balance (phase 3 to 4). This corresponds to a single mutational step that is on the order of the width of the competition kernel, <span class="math">\(\sigma_c\)</span>. Here branching is accomplished essentially by the single unlikely event being “rolled,” and transitions between phases are slow but rarely collapse to an earlier stage. When mutational step size is limiting, many mutational steps are required to get any population a distance of order <span class="math">\(\sigma_c\)</span> away - to escape the shadow of competition. In this regime, successful branching appears as a lucky string of mutations, like a long series of flipping a coin and coming up heads rather than the singular improbable event. This regime is characterized by many aborted branching attempts before one succeeds. The smaller <span class="math">\(\mu\)</span> becomes, the smaller the chances of seeing this lucky run within the coexistence time. The smaller <span class="math">\(\sigma_{\mu}\)</span> becomes the smaller the chances of seing the rare large jump within the coexistence time. When both are too small relative to the coexistence time, the population will fail to branch.</p>
<h2 id="approaching-the-branching-point">Approaching the branching point</h2>
<p>Classically, the approach to the branching point is governed by the canonical equation of adaptive dynamics . To account for branching we have to revisit the original derivation of this equation where we relax the limit of small mutational steps sufficiently to allow mutants to enter the coexitence region, <span class="math">\(P_2\)</span>. The derivation of the canonical equation integrates only over those mutants that fall into the invasion-substitution region, <span class="math">\(P_1\)</span>. However, since the derivation is done in the limit of small mutational step sizes, this encompasses essentially all of the weight of the mutational kernel, and to good approximation can thus be replaced with the entire <span class="math">\(P_1 \cup P_2\)</span> region. Recall that in the derivation of the canonical equation, deleterious mutations are given zero probability of fixing (from the branching process approximation), and hence this corresponds to integrating over half of the real line <span class="math">\(\mathbb{R}\)</span>.</p>
<p><span class="math">\[\begin{aligned}
\frac{\mathrm{d}\bar x}{\mathrm{d}t} = \mu N^*(x) \phantom \cdot \partial_y s(y,x) \Big|_x \int_{P_1} [y-x]^2 M(y-x) \mathrm{d}[y-x]
\label{canonical}\end{aligned}\]</span></p>
<p>The probability of such a mutant occurring in our monomorphic population of trait <span class="math">\(x\)</span> is given by the probability that any mutant occurs (given by the population size, approximately <span class="math">\(K(x)\)</span> at equilibrium, times the birth rate <span class="math">\(b(x)\)</span> times the mutation rate <span class="math">\(\mu\)</span>) times the probability that the mutation lies on the opposite side of the coexistence boundary, which we denote as <span class="math">\(\phi(x)\)</span> and <span class="math">\(\psi(x)\)</span>, which is <span class="math">\(\phi(x)\)</span> reflected across the line <span class="math">\(y=x\)</span>. This depends on the mutational kernel, <span class="math">\(M(y,x)\)</span> which gives the probability that a mutant arising from a resident population of trait <span class="math">\(x\)</span> bears trait <span class="math">\(y\)</span> that falls withing the coexistance region as follows:</p>
<p><span class="math">\[\int_{-\infty}^{\phi(x)} M(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) \mathrm{d}y\]</span></p>
<p>Without loss of generality let us assume that the singular strategy <span class="math">\(x^* = 0\)</span> and that we start from some trait value <span class="math">\(x_0 &gt; x^*\)</span>. Additionally, let us we assume <span class="math">\(M(y,x)\)</span> is Gaussian in <span class="math">\(y-x\)</span> with mean 0 and variance <span class="math">\(\sigma_{\mu}^2\)</span>. However, we do not wish to consider all such mutants <span class="math">\(y\)</span>, but only those that survive. We multiply the probability of a mutant having trait <span class="math">\(y\)</span>, <span class="math">\(M(y,x)\)</span>, times the probability that is survives drift. This probability we quote from the Galton-Watson branching process, <span class="math">\(1-\tfrac{d(y,x)}{b(y,x)}\)</span>. Using our model for birth and death rates , the probability of surviving branching is</p>
<p><span class="math">\[1-\frac{C(y,x)K(x)}{K(y)} := S(y,x)
\label{S}\]</span></p>
<p>which we denote as <span class="math">\(S(y,x)\)</span> as indicated. Hence we modify our integral to consider all mutants <span class="math">\(y &lt; x^*\)</span> which occur with probability <span class="math">\(M(y,x)\)</span> and then survive with probability <span class="math">\(S(y,x)\)</span>, and write down the rate <span class="math">\(P(x)\)</span> at which a mutant which leads to branching occurs from our monomorphic population with trait <span class="math">\(x\)</span>:</p>
<p><span class="math">\[P(x) := r \mu K(x)\left( \int_{-\infty}^{\phi(x)} M(y,x) S(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) S(y,x) \mathrm{d}y  \right)
\label{MSerf}\]</span></p>
<p>Though a little cumbersome, this can be written in nearly closed form (using the error function). For our particular model <span class="math">\(s(y,x)\)</span>, we can write the boundaries <span class="math">\(\phi(x)\)</span> and <span class="math">\(\psi(x)\)</span> as</p>
<p><span class="math">\[\begin{aligned}
\phi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}+1}{\frac{\sigma_k^2}{\sigma_c^2}-1} \nonumber \\
\psi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}-1}{\frac{\sigma_k^2}{\sigma_c^2}+1}
\label{phipsi}\end{aligned}\]</span></p>
<p>Then, given a starting condition <span class="math">\(x_0\)</span>, we can determine the expected trait <span class="math">\(x\)</span> at time <span class="math">\(t\)</span> of a monomorphic resident population by integrating the canonical equation,</p>
<p><span class="math">\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{1}{2} \mu \sigma_{mu}^2 N^*(x) \partial_y s(y,x)\]</span></p>
<p>which for our model is</p>
<p><span class="math">\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{-x}{2\sigma_k^2} r \mu \sigma_{\mu}^2 K(x)\]</span></p>
<p>While no closed form solution exists for <span class="math">\(x(t)\)</span> in this case, if we assume <span class="math">\(x_0 \ll \sigma_k\)</span> then to good approximation we can view <span class="math">\(K(x)\)</span> to be constant over the interval and take our path to be:</p>
<p><span class="math">\[x(t) = x_0 \exp\left( -r \mu \sigma_{\mu}^2 K_0 t/\sigma_k^2\right)\]</span></p>
<p>Using this mean path, we can write down an approximation for the rate of a branching mutant occurring as a function of time, <span class="math">\(P(x(t))\)</span>. Using this time dependent rate, the probability of not branching after time <span class="math">\(T\)</span> is simply <span class="math">\(\exp\left( - \int_0^T P(t)\mathrm{d}t \right)\)</span>. One minus this is the probability branching by time <span class="math">\(T\)</span>; i.e. the cumulative density function, hence the probability density function for the waiting time is:</p>
<p><span class="math">\[\Pi(T) = P(x(T)) \exp\left( -\int_0^T P(x(t)) \right)
\label{pdf}\]</span></p>
<p>and the expected time to complete phases 1 and 2 is <span class="math">\(\int_0^{\infty} T \Pi(T) \mathrm{d}T\)</span>. This is our first analytic approximation.</p>
<h2 id="coexistence">Coexistence</h2>
<p>Consider a population of two coexisting types, characterized by traits <span class="math">\(x_1\)</span> and <span class="math">\(x_2\)</span> respectively. The birth and death rates of each population are then given by expression  . We’ll assume that the populations can coexist, that is <span class="math">\((x_1, x_2)\)</span> falls into the coexistence region <span class="math">\(P_2\)</span>; <em>i.e.</em> that $C(x_1,x_2)K(x_2) /K_1(x_1) &lt; 1 $ and <span class="math">\(C(x_1, x_2) K(x_1)/K(x_2) &lt; 1\)</span>. This guarentees that each population has a positive expected growth rate when rare. However, because the population is composed of finitely many discrete individuals, there is still a chance that either type will be lost to chance; to demographic stochasticity. We whish to characterize the expected waiting time for such an event to occur.</p>
<p>To do so, we will switch first into density and then frequency, to obtain a one-dimensional expression we can solve exactly. We will then use the Arhennius approximation to obtain a closed form solution. First, we will replace the discrete number of individuals <span class="math">\(N\)</span> with the macroscopic, continuous variable <span class="math">\(n\)</span>, representing the mean <em>density</em> of individuals; <span class="math">\(N/A\)</span>, where <span class="math">\(A\)</span> is the area in which <span class="math">\(N\)</span> individuals are found. For suitably large <span class="math">\(A\)</span>, we will be able to accurately describe <span class="math">\(n\)</span> with a coupled stochastic differential equation for each population. By changing variables once more into the frequency of one type, <span class="math">\(p = n_1/(n_1+n_2)\)</span> and <span class="math">\(n = n_1 + n_2\)</span>, we are able to do a timescale seperation to focus on the dynamics in a single variable, <span class="math">\(p\)</span>.</p>
<p>The master equation that describes the probability of observing <span class="math">\(N_i\)</span> individuals of type <span class="math">\(i\)</span> is given by,</p>
<p><span class="math">\[\begin{aligned}
\frac{\mathrm{d}}{\mathrm{d}t} P(N_1,t) &amp;= (\text{E}_1 - 1) r N_1 \frac{N_1 + C(x_1, x_2) N_2}{K(x_1) }P(N_1) + (\text{E}_1^{-1} - 1)r N_1 P(N_1) \nonumber \\
\frac{\mathrm{d}}{\mathrm{d}t} P(N_2,t) &amp;= (\text{E}_2 - 1) r N_2 \frac{N_2 + C(x_2, x_1) N_1}{K(x_2) }P(N_2) + (\text{E}_2^{-1} - 1)r N_2 P(N_2)
\label{mastereq}\end{aligned}\]</span></p>
<p>where <span class="math">\(\text{E}_i^k\)</span> is the step operator taking <span class="math">\(f(N_i) \to f(N_{i+k})\)</span>. We apply van Kampen’s expansion of the master equation to linear order to recover the following stochastic differential equation (Itô equation)</p>
<p><span class="math">\[\begin{aligned}
\mathrm{d}n_1 = r n_1 \left(1 -  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o} } \sqrt{r n_1 \left(1 +  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) } \mathrm{d}W_1
\label{sde}\end{aligned}\]</span></p>
<p>and <span class="math">\(n_2\)</span> similarly. Switching into the variables for frequency, <span class="math">\(p = n_1/n\)</span> and <span class="math">\(n = n_1+n_2\)</span> and simplying notation by <span class="math">\(C(x_1, x_2) = c_{12}\)</span> and <span class="math">\(K(X_i) = k_i\)</span>:</p>
<p><span class="math">\[\begin{aligned}
\mathrm{d}p &amp;= r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o n(p)} } \sqrt{r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right) } \mathrm{d}W_1  \label{freq_sde} \\
n(p) &amp;=  \frac{k_1 k_2}{k_2 p^2 + (k_1+k_2) c_{12} p (1-p) + k1 (1-p)^2 }, \end{aligned}\]</span></p>
<p>where we have set the dynamic equation for <span class="math">\(n(p)\)</span> to equilibrium. The extinction probability <span class="math">\(u(p,t)\)</span> for this expression is given by the Backwards equation for the generator,</p>
<p><span class="math">\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \underbrace{r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right)}_{A(p)} \partial_p u(p,t) + \tfrac{1}{2} \underbrace{\frac{1}{K_o n(p) } r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right)}_{B(p)} \partial_p^2 u(p,t) 
\label{u}\]</span></p>
<p>with the boundary conditions <span class="math">\(u(0,t) = 1\)</span> and <span class="math">\(u(1,t) = 1\)</span> being absorbing.</p>
<p>Assuming that type 1 is the rare mutant invader, we can solve this explicitly for small <span class="math">\(p\)</span>, and particularly for the case of exactly one new mutant. After some rearrangement we can rewrite this as</p>
<p><span class="math">\[\begin{gathered}
\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \left( rp \left( 1-\frac{n c_{12}}{k_1} \right) - \frac{r n}{k_1} p^2 (1 - c_{12} )\right)  \partial_p u(p,t) \\
+ \left( rp \left(1+\frac{n c_{12}}{k_1}\right)  + \frac{r n }{k_1} p^2 (1 - c_{12} ) \right) \frac{\partial_p^2 u(p,t)}{2K_0 n}\end{gathered}\]</span></p>
<p>Note then for <span class="math">\(p\)</span> small we can neglect the terms quadratic in <span class="math">\(p\)</span> and we are left with the backwards equation from the density independent case,</p>
<p><span class="math">\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) =  rp \left( 1-\frac{n c_{12}}{k_1} \right)   \partial_p u(p,t) + rp \left(1+\frac{n c_{12}}{k_1}\right)   \frac{\partial_p^2 u(p,t)}{2K_0 n}\]</span></p>
<p>Setting equal to zero we have a simple ordinary differential equation for the stationary extinction probability:</p>
<p><span class="math">\[\begin{aligned}
u(p) &amp;= 1 - e^{-2sp K_0 n} \\
s &amp;= \frac{r\left( 1-\frac{n c_{12}}{k_1} \right) }{ r\left(1+\frac{n c_{12}}{k_1}\right)} \end{aligned}\]</span></p>
<p>and particularly for a frequency <span class="math">\(p\)</span> corresponding to a single individual, a frequency of <span class="math">\(p=1/(N_1+N_2) =(1/K_0)/(n_1+n_2) = 1/(K_0 n)\)</span>, this reduces to</p>
<p><span class="math">\[u = 1-e^{-2s}\]</span></p>
<p>Assuming $ rp ( 1- ) 0$, the time-dependent solution<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> is:</p>
<p><span class="math">\[\begin{aligned}
u(p,t) &amp;= 1-e^{-p \psi(t) } \\
\psi(t) &amp;= \frac{2 s K_0 n}{1-e^{ r\left( 1-\frac{k_2 c_{12}}{k_1} \right) t } }
\label{timedep}\end{aligned}\]</span></p>
<p>Larger population (system size) <span class="math">\(K_o\)</span> results in longer persistance.</p>
<p>This tells us nothing about the survival of the resident, as it is only valid for small <span class="math">\(p\)</span>. In most applications of this approach, it is assumed the resident quickly goes extinct once <span class="math">\(p \sim o(1)\)</span>. If we consider the asymptotic behavior of the nonlinear PDE, Eq. , we see sure absorbtion at one boundary or the other. The asymptotic behavior needn’t concern us; as we really want to know how the expected lifetime of this dimporphic state compares with the rate at which mutants are entering this population. To do so we need the time dependent solution to the nonlinear backwards equation .</p>
<p>While a direct solution to the nonlinear PDE is not available, we can solve for the moments analytically. As <span class="math">\(u(p,t)\)</span> is the probability of non-extinction, that is, that the exit time <span class="math">\(T\)</span> is greater than the current time <span class="math">\(t\)</span>; e.g. <span class="math">\(u\)</span> is the cumululative probability density. Consequently the mean exit time <span class="math">\(T(p)\)</span> is given by,</p>
<p><span class="math">\[T(p) = - \int_0^\infty t \partial_t u(p,t) \mathrm{d}t = \int_0^\infty u(p,t) \mathrm{d}t \label{simple}\]</span></p>
<p>where we have integrated by parts to get the second expression. Meanwhile, we can integrate the left-hand side of ,</p>
<p><span class="math">\[\int_0^{\infty} \partial_t u(p,t) \mathrm{d}t = u(p,\infty) - u(p,0) = -1\]</span></p>
<p>and integrate the right hand side using  to get</p>
<p><span class="math">\[A(p) \partial_p T(p) + \tfrac{1}{2} B(p) \partial_p^2 T(x) = -1\]</span></p>
<p>This can be integrated directly to solve for the mean time starting from <span class="math">\(p=x\)</span> to be absorbed at either boundary <span class="math">\(a=0\)</span> or <span class="math">\(b=1\)</span>:</p>
<p><span class="math">\[\begin{aligned}
T(x) &amp;= \frac{2 \left[\left(\int_a^x\frac{\mathrm{d}y}{\psi(y)}\right)\int_x^b \frac{\mathrm{d}y&#39;}{\psi(y&#39;)} \int_a^{y&#39;} \frac{\mathrm{d}z \psi(z)}{B(z)} - \left(\int_x^b\frac{\mathrm{d}y}{\psi(y)}\right)\int_a^x \frac{\mathrm{d}y&#39;}{\psi(y&#39;)} \int_a^{y&#39;} \frac{\mathrm{d}z \psi(z)}{B(z)}\right]}{\int_a^b \frac{\mathrm{d}y}{\psi(y)}}
\label{7integrals} 
\intertext{where}
\psi(x) &amp;= \exp\left( \int_0^x \mathrm{d}x&#39; \frac{2A(x&#39;)}{B(x&#39;)} \right)\end{aligned}\]</span></p>
<p>Though these integrals can be computed numerically, a small noise limit (large populations) allows us to make an additional approximation by mapping this problem onto the familiar question of escape over a potential energy barrier. This question arises in basic chemistry, and is described by a similar stochastic differential equation where the <span class="math">\(A(x)\)</span> coefficent represents the gradient of the energy surface and <span class="math">\(B\)</span> the temperature. The analogy initially appears to fail, since in the chemical context the diffusion coefficent is determined by the temperature alone, and is independent of the state, while our <span class="math">\(B\)</span> term depends on the frequency <span class="math">\(p\)</span>. However, as it is not explicitly time dependent, there is always a transform to change variables into a context where <span class="math">\(B\)</span> is constant. The relevant transformation for us is known as the Lamperti Transform. Switching variables from <span class="math">\(p\)</span> to <span class="math">\(q\)</span> by means of the transform:</p>
<p><span class="math">\[q = F(p) = \int_z^{p} \frac{1}{\sqrt{B(u)}} \mathrm{d}u
\label{p_to_q}\]</span></p>
<p>we can rewrite  as</p>
<p><span class="math">\[\begin{aligned}
\frac{\partial u(q,t)}{\partial t} = \underbrace{\left(\frac{4 A(p)- \partial_p B(p) }{4\sqrt{B(p)}}  \right)}_{\nabla V(p)} \frac{\partial u(q,t)}{\partial q} + \frac{1}{2} \frac{\partial^2 u(q,t)}{\partial q^2}.
\label{new_u}\end{aligned}\]</span></p>
<p>The mean first passage time in this transformed variable is still solved by . However, interpreting the coefficent of the drift term as the gradient of the energy landscape, <span class="math">\(\nabla V(p)\)</span>, we can approximate that this time will scale as the exponent of the depth of the energy well defined by that landscape:</p>
<p><span class="math">\[\exp{- (\min(V(0), V(1)) - V(p^*) )}\]</span></p>
<h1 id="results">Results</h1>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>note that <span class="math">\(n(p) \approx k_2\)</span> for small <span class="math">\(p\)</span>.<a href="#fnref1">↩</a></p></li>
</ol>
</section>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:https://ogp.me/ns/article#">
  <p> <i class="icon-calendar"></i>
    <time datetime="2010-04-20 00:00:00 +0000" 
    property="dc:created">20 Apr 2010</time></p>
   

 <br />

  
	<p><a class="btn btn-default" rel="prev" href='/2010/04/20/R-sig-phylo.html'><i class="icon-chevron-left"></i> prev</a>
  
  
  <a class="btn btn-default" rel="next" href='/2010/04/21/Adaptive-Dynamics.html'>next <i class="icon-chevron-right"></i></a></p>
  

  <br />

  <p> <a  onclick="recordOutboundLink(this, 'Outbound Links', 'history'); 
            return false;" 
          class="btn btn-default" 
          href="https://github.com/cboettig/2010/commits/master/_posts/2010-04-20-waiting-time.md"><i class="icon-time"></i> history</a></p>

  <br />

  <p><i class="icon-list"></i> Posted in 
     
      <a rel="dc:subject" class="category" 
         href="/2010/categories.html#evolution">evolution</a>
    
    </p>

  <p> <i class="icon-tag"></i> tags: 
    
    <!-- https://schema.org/BlogPosting/keywords -->
    <a rel="og:tag" class="tag" 
			href="/2010/tags.html#adaptive-dynamics">#adaptive-dynamics</a>
    </p>

  <br/>

  

  <br/>
  <p><small> <i class="icon-barcode"></i> SHA Hash: <a href="https://github.com/cboettig/2010/commit/ec97b226ec9d4f8a071541b94d4374e52688cc23/_posts/2010-04-20-waiting-time.md"> ec97b226ec9d4f8a071541b94d4374e52688cc23</a></small></p>
    
  <br/>
  

</aside>

    </div>
  </div>
</div>

      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="col-md-8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>






      <footer class="footer">

<!--************** FOAF information to social networks ***************************** -->
  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://www.carlboettiger.info#me">
      <p>
          <script type="text/javascript" src="/assets/js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
      <!--
          <a rel="foaf:account" href="https://plus.google.com/" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); 
             return false;"><i class="fa fa-google-plus"></i></a>

          <a rel="foaf:account" href="https://www.mendeley.com/profiles/carl-boettiger" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); 
             return false;"><img src="/assets/img/icon-mendeley.png" /></a> 

           citations on google-scholar

           stackoverflow
      -->
      <a rel="foaf:weblog" type="application/atom+xml" href="/blog.xml"  
         class="showtooltip" title="RSS feeds for my blog-style entries. See the feed on my lab notebook (/atom.xml) to follow all entries instead." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    <!--**************** End social links **************************** -->


    <div class="col-md-4 col-md-offset-1 col-xs-4">
      <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="https://onsclaims.wikispaces.com/"><img src="/assets/img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="https://creativecommons.org/ns#license" href="https://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="/assets/img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>


  
<!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
  <span
      class="Z3988" 
      title="ctx_ver=Z39.88-2004
      &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
      &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
      &amp;rft.title=Waiting Time
      &amp;rft.creator=Carl Boettiger
      &amp;rft.date=2010-04-20
      &amp;rft.language=EN
      &amp;rft.rights=CC0
      &amp;rft_id=https://www.carlboettiger.info/04/20/waiting-time.html">
  </span>


</footer>




          <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <!-- JQuery, used on a few pages (still?) -->
    <!-- <script type="text/javascript" src="/assets/js/jquery.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <!--  <script src="/assets/js/bootstrap.min.js"></script> -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>


    

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>




    </div>
  </body>
</html>
   
