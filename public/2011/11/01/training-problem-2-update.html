<!DOCTYPE html>
<html lang="en" xmlns="https://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: https://purl.org/dc/terms/ og: http://ogp.me/ns#"> <!-- namespaces used in metadata.html -->
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
  <title>Training Problem 2 update</title>
  <meta name="author" content="Carl Boettiger" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- HTML5 metadata -->
<meta name="keywords" content="pdg-control" />
<meta name="description" content="" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Training Problem 2 update" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2011-11-01 14:20:08 +0000" />
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:identifier" content="/11/01/training-problem-2-update.html" />
<meta property="dc:rights" content="CC0" />
<meta property="dc:source" content="Lab Notebook" />
<meta property="dc:subject" content="Ecology" /> 
<meta property="dc:type" content="website" /> 
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Training Problem 2 update" />
<meta property="og:author" content="https://www.carlboettiger.info/index.html#me" />  <!-- Should be Liquid? URI? -->
<meta property="https://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="https://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="https://ogp.me/ns/article#published_time" content="2011-11-01 14:20:08 +0000" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="https://www.carlboettiger.info/11/01/training-problem-2-update.html" />
<meta property="og:type" content="website" /> 
<!-- Google Scholar Metadata -->
<!--
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_date" content="2011-11-01 14:20:08 +0000"/>
<meta name="citation_title" content="Training Problem 2 update"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
-->
<!--NOTE: see also the COinS Metadata in span element in footer -->




	<link href="https://www.carlboettiger.info/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <!-- Help the browser identify the RSS feed automatically -->
  <link rel="alternate" type="application/rss+xml" title="Carl Boettiger's Lab Notebook" href="/blog.xml" />
</head>


  <body prefix="dc: https://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/"> 
    <!-- Navbar  ================================================== -->

<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/README.html"><i class="icon-info-sign"></i></a>
    </div>

 <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

          <li  >
          <a href="/index.html">Home</a></li>
          <li  >
          <a href="/vita.html">Vita</a></li>
          <li  >
          <a href="/research.html">Research</a></li>
          <li  >
          <a href="/teaching.html">Teaching</a></li>
          <li  >
          <a href="/community.html">Community</a></li>
          <li  >
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>

      <!-- Search site using Google's index -->
        <form class="navbar-form navbar-right" role="search" method="get" action="https://google.com/search">
          <div class="form-group">
            <input type="hidden" name="q" value="site:carlboettiger.info" />
            <input type="text" class="form-control search-query" name="q" placeholder="Search"/>
          </div>
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
       </form>

    </div><!--/.nav-collapse -->
  </div> <!-- /container -->
</nav>



    <div class="container"> <!-- Responsive grid layout, doesn't jump to full-width --> 
      <header>
        <h1 class="entry-title">Training Problem 2 update</h1>
        <h2></h2>
      </header>

      <div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h2 id="problem-statement">Problem Statement</h2>
<p>We consider the stochastic optimal control problem of fisheries harvests under the scenarios involving alternate stable states, with uncertainty about the parameters of harvest. We consider a series of introductory problems to prepare us for the full problem. We begin with classical optimal control approaches (Pontraygin’s principle to transform into an ordinary differential equation boundary-value problem) for continuous time state equations (fish population dynamics) as a reference point. We begin with a one-dimensional state equation. We next consider the discrete-time state equation, which we approach with the Bellman/dynamic programming solution, as a useful starting point for the stochastic control. The continuous-time problem can solved from the Hamilton-Jacobi-Bellman PDE, instead of the BVP. While this is less efficient numerically, it generalizes to the stochastic case most naturally. The stochastic solution for the optimal path still assumes perfect knowledge. We can accommodate uncertainty in the state variables in a Bayesian learning framework.</p>
<p>So far I (Carl) am about half-way through these toy examples which will help set up the training problem.  Once we have a common set of tools and code we have quite a few questions to explore within the uncertainty problem.</p>
<p>(See <a href="https://www.carlboettiger.info/archives/2655">original</a> task description)</p>
<h2 id="introductory-problem-by-pontryagin-minimization">Introductory Problem by Pontryagin minimization</h2>
<p>Optimal control with an allee effect. Continuous time, Pontraygin’s minimum principle for the first-order conditions to establish a boundary value problem.</p>
<ul>
<li><p><a href="https://www.carlboettiger.info/archives/3001">BVP derivation</a></p></li>
<li><p><a href="https://www.carlboettiger.info/archives/3049">Numerical solutions</a> in several cases</p></li>
<li><p><a href="https://github.com/cboettig/pdg_control/">Code</a> for numerics</p></li>
</ul>
<h2 id="discrete-problem-by-bellman-equation-dynamic-programming">Discrete problem by Bellman equation, Dynamic Programming</h2>
<p>Optimal control for the analogous discrete time state equations.  Provides a dynamic programming example solution, introduces the cost-to-go.</p>
<ul>
<li><p>Problem setup <a href="https://www.carlboettiger.info/archives/3076">notes</a>.</p></li>
<li><p>Code</p></li>
</ul>
<h2 id="continuous-problem-by-hamilton-jacobi-bellman-pde">Continuous problem by Hamilton-Jacobi-Bellman PDE</h2>
<p>As in the introductory problem. Discritize $ dt $,   and then by Taylor expansion the recursion of the cost to go becomes the HJB PDE:</p>
<p><span class="math">\[ \partial_t J(x,t) = \min_h \left( U(x,h,t)  +  \beta f(x,h,t) \partial_x J(x,t)   \right) \]</span></p>
<p>and the optimal path obeys:</p>
<p><span class="math">\[ h(x,t) = \arg \min_h \left( U(x,h,t) + \beta \partial_x J(x,t) f(x,h, t) \right) \]</span></p>
<h2 id="stochastic-problem">Stochastic problem</h2>
<p>State equation is an SDE ((perhaps restricted to <span class="math">\(g(x,h,t) = 1\)</span>? )) <span class="math">\[ dx =f(x(t), h(t), t)dt + g(x(t), h(t), t) dB_t \]</span></p>
<p>and we minimize the expected cost.</p>
<p><span class="math">\[ \max_h \left( \phi( \langle x(T) \rangle ) + \left \langle \int_0^T e^{-\rho t} \pi(x,h,t) dt \right \rangle \right)\]</span></p>
<p>For a Gaussian process we solve the stochastic HJB (from taking expectations over the path gives a deterministic PDE by that name):</p>
<p><span class="math">\[ \partial_t J(x,t) = \min_h \left( U(x,h,t)  +  \beta f(x,h,t) \partial_x J(x,t)   + \frac{1}{2} \nu(x,h,t) \partial_x^2 J(x,t) \right)  \]</span></p>
<p>Where $ (x,h,t ) $ is the variance dynamics for the state equation.  This may require a numerical solution for appropriate definitions of the stochastic state model, e.g.</p>
<p>$ d X = X (1-) (  ) - X h + X dB $</p>
<p>Not as bad as it appears perhaps; for instance, <a href="https://en.wikipedia.org/wiki/Merton%27s_portfolio_problem">Merton’s portfolio problem</a> is actually an example of this nature with a closed-form solution. There are efficient numerical solutions for linear-quadratic control versions, perhaps of little use to us.</p>
<h2 id="stochastic-problem-with-uncertainty">Stochastic problem with uncertainty</h2>
<p>(Finite time-horizon). Either the parameters of the cost function or the state equation are unknown, and we update our belief about the parameters according to Bayes rule: <span class="math">\[p_{t+dt} (\alpha | dx, h) \propto p(dx | \alpha, h) p_t(\alpha) \]</span></p>
<p>We define sufficient statistics for this distribution, and have a control problem with an extra dimension in the state equations. The expected profit is computed over both dimensions: <span class="math">\[ \max_h \left \langle \phi( x(T) ) + \int_0^T e^{-\rho t} \pi(x,h,t) dt \right \rangle_{\theta, x} \]</span></p>
<h2 id="higher-dimensional-dynamics">Higher dimensional dynamics</h2>
<p>Each of these problems can then be repeated with the proper 3-dimensional parrotfish system:</p>
<p><span class="math">\[ \frac{dM}{dt} = a MC - \frac{g(P) M}{M+T}+\gamma MT \]</span></p>
<p><span class="math">\[ \frac{dC}{dt} = (rT - d-aM)C \]</span></p>
<p><span class="math">\[ \frac{dP}{dt} = sP\left( 1-\frac{P}{K(C)}\right) - fP\]</span></p>
<p>K(C) is from territorial limits, rather than food limits.  (Blackwood <em>et. al.</em> 2010)</p>
<p>Adding habitat quality (Blackwood <em>et. al.</em> 2011).</p>
<h2 id="references">References</h2>
<ul>
<li><p>Blackwood J, Hastings A and Mumby P (2010). “The Effect of Fishing on Hysteresis in Caribbean Coral Reefs.” <em>Theoretical Ecology</em>, <strong>5</strong>. ISSN 1874-1738, <a href="https://dx.doi.org/10.1007/s12080-010-0102-0">http://dx.doi.org/10.1007/s12080-010-0102-0</a>.</p></li>
<li><p>Blackwood J, Hastings A and Mumby P (2011). “A Model-Based Approach to Determine The Long-Term Effects of Multiple Interacting Stressors on Coral Reefs.” <em>Ecological Applications</em>, <strong>21</strong>. ISSN 1051-0761, <a href="https://dx.doi.org/10.1890/10-2195.1">http://dx.doi.org/10.1890/10-2195.1</a>.</p></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:https://ogp.me/ns/article#">
  <p> <i class="icon-calendar"></i>
    <time datetime="2011-11-01 14:20:08 +0000" 
    property="dc:created">01 Nov 2011</time></p>
   

 <br />

  
	<p><a class="btn btn-default" rel="prev" href='/2011/11/01/labrids-parrotfish-method1.html'><i class="icon-chevron-left"></i> prev</a>
  
  
  <a class="btn btn-default" rel="next" href='/2011/11/01/pdg-control-conference-call.html'>next <i class="icon-chevron-right"></i></a></p>
  

  <br />

  <p> <a  onclick="recordOutboundLink(this, 'Outbound Links', 'history'); 
            return false;" 
          class="btn btn-default" 
          href="https://github.com/cboettig/2011/commits/master/_posts/2011-11-01-training-problem-2-update.md"><i class="icon-time"></i> history</a></p>

  <br />

  <p><i class="icon-list"></i> Posted in 
     
      <a rel="dc:subject" class="category" 
         href="/2011/categories.html#ecology">ecology</a>
    
    </p>

  <p> <i class="icon-tag"></i> tags: 
    
    <!-- https://schema.org/BlogPosting/keywords -->
    <a rel="og:tag" class="tag" 
			href="/2011/tags.html#pdg-control">#pdg-control</a>
    </p>

  <br/>

  

  <br/>
  <p><small> <i class="icon-barcode"></i> SHA Hash: <a href="https://github.com/cboettig/2011/commit/4ca6d0667fbddf35927444fb72e2bc370b92930c/_posts/2011-11-01-training-problem-2-update.md"> 4ca6d0667fbddf35927444fb72e2bc370b92930c</a></small></p>
    
  <br/>
  

</aside>

    </div>
  </div>
</div>

      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="col-md-8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>






      <footer class="footer">

<!--************** FOAF information to social networks ***************************** -->
  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://www.carlboettiger.info#me">
      <p>
          <script type="text/javascript" src="/assets/js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
      <!--
          <a rel="foaf:account" href="https://plus.google.com/" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); 
             return false;"><i class="fa fa-google-plus"></i></a>

          <a rel="foaf:account" href="https://www.mendeley.com/profiles/carl-boettiger" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); 
             return false;"><img src="/assets/img/icon-mendeley.png" /></a> 

           citations on google-scholar

           stackoverflow
      -->
      <a rel="foaf:weblog" type="application/atom+xml" href="/blog.xml"  
         class="showtooltip" title="RSS feeds for my blog-style entries. See the feed on my lab notebook (/atom.xml) to follow all entries instead." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    <!--**************** End social links **************************** -->


    <div class="col-md-4 col-md-offset-1 col-xs-4">
      <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="https://onsclaims.wikispaces.com/"><img src="/assets/img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="https://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="/assets/img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>


  
<!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
  <span
      class="Z3988" 
      title="ctx_ver=Z39.88-2004
      &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
      &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
      &amp;rft.title=Training Problem 2 update
      &amp;rft.creator=Carl Boettiger
      &amp;rft.date=2011-11-01
      &amp;rft.language=EN
      &amp;rft.rights=CC0
      &amp;rft_id=https://www.carlboettiger.info/11/01/training-problem-2-update.html">
  </span>


</footer>




          <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <!-- JQuery, used on a few pages (still?) -->
    <!-- <script type="text/javascript" src="/assets/js/jquery.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <!--  <script src="/assets/js/bootstrap.min.js"></script> -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>


    

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>




    </div>
  </body>
</html>
   
