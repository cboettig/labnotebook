<!DOCTYPE html>
<html lang="en" xmlns="https://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: https://purl.org/dc/terms/ og: https://ogp.me/ns#"> <!-- namespaces used in metadata.html -->
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
  <title>Friday: Notes on Labrids, notes on Transforms and size-corrections</title>
  <meta name="author" content="Carl Boettiger" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- HTML5 metadata -->
<meta name="keywords" content="" />
<meta name="description" content="" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Friday: Notes on Labrids, notes on Transforms and size-corrections" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2011-04-29 22:19:43 +0000" />
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:identifier" content="/04/29/friday-notes-on-labrids-notes-on-transforms-and-size-corrections.html" />
<meta property="dc:rights" content="CC0" />
<meta property="dc:source" content="Lab Notebook" />
<meta property="dc:subject" content="Ecology" /> 
<meta property="dc:type" content="website" /> 
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Friday: Notes on Labrids, notes on Transforms and size-corrections" />
<meta property="og:author" content="https://www.carlboettiger.info/index.html#me" />  <!-- Should be Liquid? URI? -->
<meta property="https://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="https://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="https://ogp.me/ns/article#published_time" content="2011-04-29 22:19:43 +0000" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="https://www.carlboettiger.info/04/29/friday-notes-on-labrids-notes-on-transforms-and-size-corrections.html" />
<meta property="og:type" content="website" /> 
<!-- Google Scholar Metadata -->
<!--
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_date" content="2011-04-29 22:19:43 +0000"/>
<meta name="citation_title" content="Friday: Notes on Labrids, notes on Transforms and size-corrections"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
-->
<!--NOTE: see also the COinS Metadata in span element in footer -->




	<link href="https://www.carlboettiger.info/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <!-- Help the browser identify the RSS feed automatically -->
  <link rel="alternate" type="application/rss+xml" title="Carl Boettiger's Lab Notebook" href="/blog.xml" />
</head>


  <body prefix="dc: https://purl.org/dc/terms/ foaf: https://xmlns.com/foaf/0.1/"> 
    <!-- Navbar  ================================================== -->

<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/README.html"><i class="icon-info-sign"></i></a>
    </div>

 <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

          <li  >
          <a href="/index.html">Home</a></li>
          <li  >
          <a href="/vita.html">Vita</a></li>
          <li  >
          <a href="/research.html">Research</a></li>
          <li  >
          <a href="/teaching.html">Teaching</a></li>
          <li  >
          <a href="/community.html">Community</a></li>
          <li  >
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>

      <!-- Search site using Google's index -->
        <form class="navbar-form navbar-right" role="search" method="get" action="https://google.com/search">
          <div class="form-group">
            <input type="hidden" name="q" value="site:carlboettiger.info" />
            <input type="text" class="form-control search-query" name="q" placeholder="Search"/>
          </div>
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
       </form>

    </div><!--/.nav-collapse -->
  </div> <!-- /container -->
</nav>



    <div class="container"> <!-- Responsive grid layout, doesn't jump to full-width --> 
      <header>
        <h1 class="entry-title">Friday: Notes on Labrids, notes on Transforms and size-corrections</h1>
        <h2></h2>
      </header>

      <div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <p>The specific traits were:</p>
<p>Oral Jaw traits</p>
<ol type="1">
<li><p>mouth-closing lever ratio (Close),</p></li>
<li><p>mouth-opening lever ratio (Open), kinematic</p></li>
<li><p>transmission coefficient of the oral jaws four-bar linkage (Jaw KT),</p></li>
<li><p>adductor mandibulae (AM) muscle mass,</p></li>
<li><p>premaxillary protrusion distance (Prot),</p></li>
<li><p>gape width (Gape),</p></li>
</ol>
<p>Exterior to the Oral Jaws, not expected to become unconstrained:</p>
<ul>
<li><p>levator posterior (LP) muscle mass: (Pharyngeal jaw muscle)</p></li>
<li><p>sterno-hyoideus (SH) muscle mass, (Primarily buccual cavity)</p></li>
<li><p>adult body mass (Body mass).</p></li>
</ul>
<p>See (WAINWRIGHT <em>et. al.</em> 2004).</p>
<p>Species: 122 in dataset (34 parrotfish, 88 wrasses)</p>
<p>Species in phylogeny: 34 parrotfish. 80 wrasses.  Hmm, my phylogeny is missing 8 wrasses.</p>
<h2 id="transforms">Transforms</h2>
<p>In (Price <em>et. al.</em> 2010), all linear lengths are log-transformed, masses are log transformed after cube-root transform. Why: An assumption of linear growth with percent, combined with an allometry that makes all linear dimensions increase together (hence mass increases by the cube of any increase in a length). Should evolution really preserve such an allometry? Does the cube root matter, since it’s just a multiplicative scaling constant once we are in log space?</p>
<p>What about the lever ratios? assume they are untransformed? Also uncorrected for mass?</p>
<p>These log-transformed traits are then used to compute contrasts. Contrasts are regressed through the origin against body-mass. This regression is then used to get residuals of the log-traits, and these residuals are modeled as BM or OU, etc.</p>
<p>Size-correction can seem rather challenging.  Of course evolution of different traits (rates of evolution, shifts, etc) are correlated, and as most traits couple strongly to size and size explains a great deal of disparity, lack of size-corrections risk data that appears to be, say, showing shifts in rate of jaw evolution when it instead shows shifts in the rate of body-size evolution.  Hence the need for size correction.</p>
<p>A common though non-ideal method is a linear regression of log-trait values against log-size.  This regression assumes that you have a bunch of measurements of (tooth size, body size) which are independent of each other. Because of the phylogeny, you don’t (the classic Felsenstein 1985 situation). The standard approach leaves you with independent contrasts, not the traits themselves.  Recall that we just want to do the regression correctly, we weren’t ready to remove the effect of phylogeny, since we’re still gearing up to do a comparative method .</p>
<p>Revell takes great care to address this issue, (Revell, 2009) demonstrating how we get corrected values of the traits themselves, rather than being left with contrasts.</p>
<blockquote>
<p>Types of analyses that might require transformed values for tip species include (but are not limited to): the estimation of phylogenetic signal (Freckleton et al. 2002; Blomberg et al. 2003); ancestral state reconstruction (Schluter et al. 1997); the phylogenetic analysis of variance (ANOVA) or analysis of covariance (ANCOVA) (Garland et al. 1993); and phylogenetic regression in which both slope and intercept (or prediction in the species space) are of concern (Rohlf 2001).</p>
</blockquote>
<p>Getting the size-correction using the phylogeny does not mean that we are done with the phylogeny – the size-corrected values trait still have phylogenetic correlations, this just means we did the linear regression correctly in order to size correct in the first place, which as Revell cites, may not be the right way to size correct anyway, see Garcia_Berthou (2001), Freckleton(2002, 2009).</p>
<p>This attempts to correct for body-mass in a phylogenetic manner – under the assumptions:</p>
<ol type="a">
<li><p>There is a linear relationship between body mass and other traits $ () ()$</p></li>
<li><p>Though the relationship comes from a functional constraint, samples from a phylogeny aren’t independent – giving us a false representation of power.</p></li>
</ol>
<p>At this stage we aren’t trying to create independent samples of the functional process that connects to traits. We just want to identify what quantity we hypothesize follows our evolutionary model of little steps. We can convincingly argue that it isn’t the length – we think of growth by percent increases – a mutation equally likely to increase or decrease the length by 1%, say, rather than by 1cm. Logs do this for us.</p>
<p>Unfortunately it seems difficult to argue that residuals have this same natural interpretation, particularly when we would like to insist that both the traits and the residuals follow one of the common models (i.e. Brownian motion).</p>
<p>Assume the focal trait <em>X</em> and the body size <em>Y</em> are Brownian, in order to justify the Brownian-based phylogenetic Revell collection.  The residuals  <em>Z</em> are differences between these:</p>
<p><span class="math">\[ dX_t = \sigma_{X} dB_{1} \]</span> <span class="math">\[ dY_t = \sigma_{Y} dB_{2} \]</span></p>
<p>The solutions to these are Gaussians, unfortunately the regression <span class="math">\[\beta\]</span> doesn’t result in residuals that are also Gaussians,</p>
<p><span class="math">\[ Z_t = X_t - \beta Y_t \]</span> <span class="math">\[ Z_t = N(\sigma_X) - \beta N(\sigma_Y) \]</span></p>
<p>which is not normally distributed (sums of normals aren’t normals).  (Note that this differs from the standard regression in which there is only one source of noise, $ y ~ x + $).  The same is true for any of the common phylogenetic models, which are all multivariate normal distributions.</p>
<p>It seems impossible to do the phylogenetic correction of (Revell, 2009) consistently.  One could instead assert that the ratio of some size to body-size is, say, Brownian, without asserting that the individual traits are Brownian, and have a perhaps more consistent size correction.</p>
<h2 id="references">References</h2>
<ul>
<li><p>WAINWRIGHT P, BELLWOOD D, WESTNEAT M, GRUBICH J and HOEY A (2004). “A Functional Morphospace For The Skull of Labrid Fishes: Patterns of Diversity in A Complex Biomechanical System.” <em>Biological Journal of The Linnean Society</em>, <strong>82</strong>. <a href="https://dx.doi.org/10.1111/j.1095-8312.2004.00313.x">https://dx.doi.org/10.1111/j.1095-8312.2004.00313.x</a>.</p></li>
<li><p>Price S, Wainwright P, Bellwood D, Kazancioglu E, Collar D and Near T (2010). “Functional Innovations And Morphological Diversification in Parrotfish.” <em>Evolution</em>. <a href="https://dx.doi.org/10.1111/j.1558-5646.2010.01036.x">https://dx.doi.org/10.1111/j.1558-5646.2010.01036.x</a>.</p></li>
<li><p>Revell L (2009). “Size-Correction And Principal Components For Interspecific Comparative Studies.” <em>Evolution</em>, <strong>63</strong>. ISSN 00143820, <a href="https://dx.doi.org/10.1111/j.1558-5646.2009.00804.x">https://dx.doi.org/10.1111/j.1558-5646.2009.00804.x</a>.</p></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:https://ogp.me/ns/article#">
  <p> <i class="icon-calendar"></i>
    <time datetime="2011-04-29 22:19:43 +0000" 
    property="dc:created">29 Apr 2011</time></p>
   

 <br />

  
	<p><a class="btn btn-default" rel="prev" href='/2012/04/28/thursday-reading-notes.html'><i class="icon-chevron-left"></i> prev</a>
  
  
  <a class="btn btn-default" rel="next" href='/2012/05/03/monday-3.html'>next <i class="icon-chevron-right"></i></a></p>
  

  <br />

  <p> <a  onclick="recordOutboundLink(this, 'Outbound Links', 'history'); 
            return false;" 
          class="btn btn-default" 
          href="https://github.com/cboettig/2012/commits/master/_posts/2011-04-29-friday-notes-on-labrids-notes-on-transforms-and-size-corrections.md"><i class="icon-time"></i> history</a></p>

  <br />

  <p><i class="icon-list"></i> Posted in 
     
      <a rel="dc:subject" class="category" 
         href="/2012/categories.html#evolution">evolution</a>
    
    </p>

  <p> <i class="icon-tag"></i> tags: 
    </p>

  <br/>

  

  <br/>
  <p><small> <i class="icon-barcode"></i> SHA Hash: <a href="https://github.com/cboettig/2012/commit/dbb400936cc5bebbbfa5193f4db11ff4149eee67/_posts/2011-04-29-friday-notes-on-labrids-notes-on-transforms-and-size-corrections.md"> dbb400936cc5bebbbfa5193f4db11ff4149eee67</a></small></p>
    
  <br/>
  

</aside>

    </div>
  </div>
</div>

      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="col-md-8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>






      <footer class="footer">

<!--************** FOAF information to social networks ***************************** -->
  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://www.carlboettiger.info#me">
      <p>
          <script type="text/javascript" src="/assets/js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
      <!--
          <a rel="foaf:account" href="https://plus.google.com/" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); 
             return false;"><i class="fa fa-google-plus"></i></a>

          <a rel="foaf:account" href="https://www.mendeley.com/profiles/carl-boettiger" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); 
             return false;"><img src="/assets/img/icon-mendeley.png" /></a> 

           citations on google-scholar

           stackoverflow
      -->
      <a rel="foaf:weblog" type="application/atom+xml" href="/blog.xml"  
         class="showtooltip" title="RSS feeds for my blog-style entries. See the feed on my lab notebook (/atom.xml) to follow all entries instead." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    <!--**************** End social links **************************** -->


    <div class="col-md-4 col-md-offset-1 col-xs-4">
      <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="https://onsclaims.wikispaces.com/"><img src="/assets/img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="https://creativecommons.org/ns#license" href="https://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="/assets/img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>


  
<!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
  <span
      class="Z3988" 
      title="ctx_ver=Z39.88-2004
      &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
      &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
      &amp;rft.title=Friday: Notes on Labrids, notes on Transforms and size-corrections
      &amp;rft.creator=Carl Boettiger
      &amp;rft.date=2011-04-29
      &amp;rft.language=EN
      &amp;rft.rights=CC0
      &amp;rft_id=https://www.carlboettiger.info/04/29/friday-notes-on-labrids-notes-on-transforms-and-size-corrections.html">
  </span>


</footer>




          <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <!-- JQuery, used on a few pages (still?) -->
    <!-- <script type="text/javascript" src="/assets/js/jquery.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <!--  <script src="/assets/js/bootstrap.min.js"></script> -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>


    

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>




    </div>
  </body>
</html>
   
