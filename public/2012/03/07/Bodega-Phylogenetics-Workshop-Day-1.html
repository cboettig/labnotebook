<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#"> <!-- namespaces used in metadata.html -->
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
  <title>Bodega Phylogenetics Workshop Day 1</title>
  <meta name="author" content="Carl Boettiger" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- HTML5 metadata -->
<meta name="keywords" content="" />
<meta name="description" content="" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Bodega Phylogenetics Workshop Day 1" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2010-03-07 00:00:00 +0000" />
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:identifier" content="/03/07/Bodega-Phylogenetics-Workshop-Day-1.html" />
<meta property="dc:rights" content="CC0" />
<meta property="dc:source" content="Lab Notebook" />
<meta property="dc:subject" content="Ecology" /> 
<meta property="dc:type" content="website" /> 
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Bodega Phylogenetics Workshop Day 1" />
<meta property="og:author" content="http://www.carlboettiger.info/index.html#me" />  <!-- Should be Liquid? URI? -->
<meta property="http://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="http://ogp.me/ns/article#published_time" content="2010-03-07 00:00:00 +0000" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="http://www.carlboettiger.info/03/07/Bodega-Phylogenetics-Workshop-Day-1.html" />
<meta property="og:type" content="website" /> 
<!-- Google Scholar Metadata -->
<!--
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_date" content="2010-03-07 00:00:00 +0000"/>
<meta name="citation_title" content="Bodega Phylogenetics Workshop Day 1"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
-->
<!--NOTE: see also the COinS Metadata in span element in footer -->




	<link href="http://www.carlboettiger.info/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <!-- Help the browser identify the RSS feed automatically -->
  <link rel="alternate" type="application/rss+xml" title="Carl Boettiger's Lab Notebook" href="/blog.xml" />
</head>


  <body prefix="dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/"> 
    <!-- Navbar  ================================================== -->

<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/README.html"><i class="icon-info-sign"></i></a>
    </div>

 <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

          <li  >
          <a href="/index.html">Home</a></li>
          <li  >
          <a href="/vita.html">Vita</a></li>
          <li  >
          <a href="/research.html">Research</a></li>
          <li  >
          <a href="/teaching.html">Teaching</a></li>
          <li  >
          <a href="/community.html">Community</a></li>
          <li  >
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>

      <!-- Search site using Google's index -->
        <form class="navbar-form navbar-right" role="search" method="get" action="http://google.com/search">
          <div class="form-group">
            <input type="hidden" name="q" value="site:carlboettiger.info" />
            <input type="text" class="form-control search-query" name="q" placeholder="Search"/>
          </div>
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
       </form>

    </div><!--/.nav-collapse -->
  </div> <!-- /container -->
</nav>



    <div class="container"> <!-- Responsive grid layout, doesn't jump to full-width --> 
      <header>
        <h1 class="entry-title">Bodega Phylogenetics Workshop Day 1</h1>
        <h2></h2>
      </header>

      <div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <p>Lecture notes for the phyolgenetics workshop. These are taken in real time, so may contain errors. I’ll see if I keep this up throughout the course. See <a href="http://bodegaphylo.wikispot.org/2010_Workshop" title="http://bodegaphylo.wikispot.org/2010_Workshop">course website.</a></p>
<h3 id="huelsenbeck">Huelsenbeck</h3>
<p>9a-11a</p>
<ul>
<li>Parameters θ</li>
<li>Observation <em>X</em></li>
<li><em>p</em>(<em>X</em> | θ) is known as the <em>likelihood.</em> Adjust parameter to maximize likelihood.</li>
<li>Coin toss example</li>
</ul>
<p>θ = prob of heads on a single toss of a coin, <em>X</em> is # of heads observed on <em>n</em> tosses. Choose a model: binomial:</p>
<figure>
<img src="http://openwetware.org/images/math/0/8/8/08814f7faf92d830f210e2d233344ecd.png" alt="p(x|\theta) = {n \choose{x}} \theta^x ( 1-\theta)^{n-x}" /><figcaption>p(x|\theta) = {n \choose{x}} \theta^x ( 1-\theta)^{n-x}</figcaption>
</figure>
<ul>
<li>Maximize likelihood, find <img src="http://openwetware.org/images/math/d/9/3/d93b13daa45e31c971a3b81deedcbc22.png" alt="\hat \theta = \frac{x}{n}" /></li>
<li>Bayesian</li>
</ul>
<figure>
<img src="http://openwetware.org/images/math/8/1/0/810d3eb56ca4c96ecbe28c931a57bdc0.png" alt="p(\theta | x) = \frac{p(x|\theta)p(\theta)}{p(x)}" /><figcaption>p(\theta | x) = \frac{p(x|\theta)p(\theta)}{p(x)}</figcaption>
</figure>
<p>likelihood times prior over marginal equals the posterior. The prior is the source of controversy, though mathematically required if you want a posterior probability.</p>
<p>The marginal can be hard to solve. <img src="http://openwetware.org/images/math/c/2/e/c2ec8ba5b21c63d5aa3063012cd7ea2b.png" alt="\int_0^1 p(x|\theta) p(\theta) d\theta" /></p>
<p>So Bayesians solved trivial problems or just estimated moments (mean, etc), until along came MCMC and they could do these integrals…</p>
<p><strong>Phylogenetic Model</strong></p>
<ul>
<li>Parameters: Tree. (comments on notation). Life is more simple than you think: all phylogenetic models are continuous time Markov models</li>
<li>“Observations:” could be:
<ul>
<li>Alignment (note that it’s not actually observed, it’s an inference from the chronogram from the sequencer! we’ll ignore that.)</li>
<li>Character matrix</li>
</ul></li>
</ul>
<p>Calculate the <strong>probability of alignment given a tree?</strong></p>
<ul>
<li>(Lecture moves to <a href="http://bodegaphylo.wikispot.org/Bayesian_Phylogenetics_(Huelsenbeck)_2010" title="http://bodegaphylo.wikispot.org/Bayesian_Phylogenetics_(Huelsenbeck)_2010">slides</a>, will probably ve available on Bodega Wiki?)</li>
<li><p>Summing over all possible combinations literally is crazy. Felsenstein Pruning algorithm (sum-product algorithm from graphical models) makes this much faster (many of those trees are related).</p></li>
<li><p>“This is the exponential distribution, it is the only distribution you’ll see/need in this course”</p></li>
</ul>
<p>moments later…</p>
<ul>
<li>“This is the gamma distribution, it is the only distribution you’ll need”</li>
<li>“Oh, and this is the Poisson distribution.”</li>
</ul>
<p><br /> <em>Dice activity: Exact simulation of finite-state continuous time Markov process</em></p>
<ul>
<li>Interesting hands-on activity to demonstrate Gillespie algorithm simulation.</li>
</ul>
<p><a href="http://en.wikipedia.org/wiki/Substitution_model" title="http://en.wikipedia.org/wiki/Substitution_model"><strong>Codon models</strong></a>.</p>
<ul>
<li>(Note, this wiki entry should be expanded).</li>
<li>Sequence model, sparse matrices with arbitrary correlations. Approximate pruning via MCMC.</li>
<li><p>Rate variation across sites.</p></li>
<li><ul>
<li>Approximate the gamma by likelihood catagories, using the mean of a catagory.</li>
</ul></li>
</ul>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><em>l</em><sub><em>i</em></sub> =</td>
<td style="text-align: left;">∑</td>
<td style="text-align: left;"><em>p</em>(<em>x</em><sub><em>i</em></sub> | <em>x</em>) / <em>k</em></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><em>k</em></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ul>
<li><ul>
<li>Heterotachy – different models on different parts of the tree.</li>
<li>Nielsen &amp; Yang 1998</li>
</ul></li>
</ul>
<p><br /> ### Jeremy Brown, Mr. Bayes</p>
<p><strong>Using Mr. Bayes</strong></p>
<ul>
<li>Can’t calculate the marginal probability. Luckily, in ratio that normalizing constant cancels out: So we can find the ratio of posterior probabilities. This is where MCMC comes in.</li>
</ul>
<p><a href="http://bodegaphylo.wikispot.org/MrBayes_Tutorial_%28Brown%29?sendfile=true&amp;file=Brown_MrBayes_Lecture.pdf&amp;download=true" title="http://bodegaphylo.wikispot.org/MrBayes_Tutorial_%28Brown%29?sendfile=true&amp;file=Brown_MrBayes_Lecture.pdf&amp;download=true">See the slides</a></p>
<h3 id="rannala-divergence-times">Rannala, Divergence Times</h3>
<ul>
<li>Molecular clock and fossil dating</li>
<li>branch lengths as estimates</li>
<li>Bayesian approaches to contain this uncertainty, given sequences times and fossil calibrations:</li>
</ul>
<figure>
<img src="http://openwetware.org/images/math/e/2/d/e2df7c8faa415cdefa1b5bab5e8f7472.png" alt="f(\theta, t, u | X) = \frac{f(X|t,u,\theta)f(u|\theta) f(t| \theta) f(\theta) }{f(X)}" /><figcaption>f(\theta, t, u | X) = \frac{f(X|t,u,\theta)f(u|\theta) f(t| \theta) f(\theta) }{f(X)}</figcaption>
</figure>
<p>substitution rate (clock) <em>u</em>, branch length <em>v</em>, age <em>t</em>.</p>
<p>Prior for the divergence times. Priors from fossils. Dangers of hard bounds (will confidently predict the wrong answer).</p>
<p>When do you have enough DNA sequence that your divergence estimate becomes limited only by fossil age uncertainty? Regress width of posterior distribution for divergence times against the mean. Once that regression is sufficiently tight, more DNA data won’t help.</p>
<ul>
<li>Irregular Molecular clocks</li>
</ul>
<p><br /> ### Tom Near, Rocks for Gel Jocks</p>
<p><strong>(a.k.a) BEAST tutorial</strong></p>
<p><a href="http://bodegaphylo.wikispot.org/BEAST_Tutorial_(Near)" title="http://bodegaphylo.wikispot.org/BEAST_Tutorial_(Near)">slides</a></p>
<p><br /> Ideas/Topics ————</p>
<ul>
<li><strong>Reaching the developers</strong>
<ul>
<li>Help lists.</li>
<li><a href="http://phylogenetics.uservoice.com/" title="http://phylogenetics.uservoice.com/">uservoice</a>.</li>
<li>stackoverflow for phylogenetics?</li>
</ul></li>
<li>Managing the literature: <a href="http://www.mendeley.com" title="http://www.mendeley.com">Mendeley</a>
<ul>
<li><a href="http://www.mendeley.com/research-papers/collections/1369391/PhylogeneticComparativeMethods/" title="http://www.mendeley.com/research-papers/collections/1369391/PhylogeneticComparativeMethods/">Phylogenetic Comparative Methods</a></li>
</ul></li>
<li>Poll faculty for useful software,tools or tricks. Attempt a talk: <em>5 minutes, 5 tools to change your life.</em>
<ul>
<li>Mendeley: an itunes for your pdfs, pandora for the literature.</li>
</ul></li>
</ul>
<p><br /> ### Thoughts/things to investigate or share</p>
<ul>
<li>When, if ever, can you actually fit a model with trending rate changes over time. i.e. can we really detect accelerating BM in character evolution?</li>
<li>Common intuitive mechanisms that generate the familiar distributions. Exponential, Poisson, Gamma, Normal, Log Normal, Binomial, Uniform, Dirchlet.</li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  <p> <i class="icon-calendar"></i>
    <time datetime="2010-03-07 00:00:00 +0000" 
    property="dc:created">07 Mar 2010</time></p>
   

 <br />

  
	<p><a class="btn btn-default" rel="prev" href='/2012/03/05/Meeting.html'><i class="icon-chevron-left"></i> prev</a>
  
  
  <a class="btn btn-default" rel="next" href='/2012/03/08/Bodega-Phylogenetics-Workshop-Day-2.html'>next <i class="icon-chevron-right"></i></a></p>
  

  <br />

  <p> <a  onclick="recordOutboundLink(this, 'Outbound Links', 'history'); 
            return false;" 
          class="btn btn-default" 
          href="https://github.com/cboettig/2012/commits/master/_posts/2010-03-07-Bodega-Phylogenetics-Workshop-Day-1.md"><i class="icon-time"></i> history</a></p>

  <br />

  <p><i class="icon-list"></i> Posted in 
     
      <a rel="dc:subject" class="category" 
         href="/2012/categories.html#evolution">evolution</a>
    
    </p>

  <p> <i class="icon-tag"></i> tags: 
    </p>

  <br/>

  

  <br/>
  <p><small> <i class="icon-barcode"></i> SHA Hash: <a href="https://github.com/cboettig/2012/commit/dbb400936cc5bebbbfa5193f4db11ff4149eee67/_posts/2010-03-07-Bodega-Phylogenetics-Workshop-Day-1.md"> dbb400936cc5bebbbfa5193f4db11ff4149eee67</a></small></p>
    
  <br/>
  

</aside>

    </div>
  </div>
</div>

      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="col-md-8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>






      <footer class="footer">

<!--************** FOAF information to social networks ***************************** -->
  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="http://www.carlboettiger.info#me">
      <p>
          <script type="text/javascript" src="/assets/js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
      <!--
          <a rel="foaf:account" href="https://plus.google.com/" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); 
             return false;"><i class="fa fa-google-plus"></i></a>

          <a rel="foaf:account" href="http://www.mendeley.com/profiles/carl-boettiger" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); 
             return false;"><img src="/assets/img/icon-mendeley.png" /></a> 

           citations on google-scholar

           stackoverflow
      -->
      <a rel="foaf:weblog" type="application/atom+xml" href="/blog.xml"  
         class="showtooltip" title="RSS feeds for my blog-style entries. See the feed on my lab notebook (/atom.xml) to follow all entries instead." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    <!--**************** End social links **************************** -->


    <div class="col-md-4 col-md-offset-1 col-xs-4">
      <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="/assets/img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="/assets/img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>


  
<!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
  <span
      class="Z3988" 
      title="ctx_ver=Z39.88-2004
      &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
      &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
      &amp;rft.title=Bodega Phylogenetics Workshop Day 1
      &amp;rft.creator=Carl Boettiger
      &amp;rft.date=2010-03-07
      &amp;rft.language=EN
      &amp;rft.rights=CC0
      &amp;rft_id=http://www.carlboettiger.info/03/07/Bodega-Phylogenetics-Workshop-Day-1.html">
  </span>


</footer>




          <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <!-- JQuery, used on a few pages (still?) -->
    <!-- <script type="text/javascript" src="/assets/js/jquery.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <!--  <script src="/assets/js/bootstrap.min.js"></script> -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>


    

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>




    </div>
  </body>
</html>
   
