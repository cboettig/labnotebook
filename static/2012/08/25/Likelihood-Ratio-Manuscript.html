<!DOCTYPE html>
<html lang="en" xmlns="https://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: https://purl.org/dc/terms/ og: https://ogp.me/ns#"> <!-- namespaces used in metadata.html -->
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
  <title>Likelihood Ratio Manuscript</title>
  <meta name="author" content="Carl Boettiger" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- HTML5 metadata -->
<meta name="keywords" content="" />
<meta name="description" content="" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Likelihood Ratio Manuscript" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2010-08-25 00:00:00 +0000" />
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:identifier" content="/08/25/Likelihood-Ratio-Manuscript.html" />
<meta property="dc:rights" content="CC0" />
<meta property="dc:source" content="Lab Notebook" />
<meta property="dc:subject" content="Ecology" /> 
<meta property="dc:type" content="website" /> 
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Likelihood Ratio Manuscript" />
<meta property="og:author" content="https://www.carlboettiger.info/index.html#me" />  <!-- Should be Liquid? URI? -->
<meta property="https://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="https://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="https://ogp.me/ns/article#published_time" content="2010-08-25 00:00:00 +0000" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="https://www.carlboettiger.info/08/25/Likelihood-Ratio-Manuscript.html" />
<meta property="og:type" content="website" /> 
<!-- Google Scholar Metadata -->
<!--
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_date" content="2010-08-25 00:00:00 +0000"/>
<meta name="citation_title" content="Likelihood Ratio Manuscript"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
-->
<!--NOTE: see also the COinS Metadata in span element in footer -->




	<link href="https://www.carlboettiger.info/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <!-- Help the browser identify the RSS feed automatically -->
  <link rel="alternate" type="application/rss+xml" title="Carl Boettiger's Lab Notebook" href="/blog.xml" />
</head>


  <body prefix="dc: https://purl.org/dc/terms/ foaf: https://xmlns.com/foaf/0.1/"> 
    <!-- Navbar  ================================================== -->

<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/README.html"><i class="icon-info-sign"></i></a>
    </div>

 <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

          <li  >
          <a href="/index.html">Home</a></li>
          <li  >
          <a href="/vita.html">Vita</a></li>
          <li  >
          <a href="/research.html">Research</a></li>
          <li  >
          <a href="/teaching.html">Teaching</a></li>
          <li  >
          <a href="/community.html">Community</a></li>
          <li  >
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>

      <!-- Search site using Google's index -->
        <form class="navbar-form navbar-right" role="search" method="get" action="https://google.com/search">
          <div class="form-group">
            <input type="hidden" name="q" value="site:carlboettiger.info" />
            <input type="text" class="form-control search-query" name="q" placeholder="Search"/>
          </div>
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
       </form>

    </div><!--/.nav-collapse -->
  </div> <!-- /container -->
</nav>



    <div class="container"> <!-- Responsive grid layout, doesn't jump to full-width --> 
      <header>
        <h1 class="entry-title">Likelihood Ratio Manuscript</h1>
        <h2></h2>
      </header>

      <div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h3 id="graham-peter-meeting">Graham &amp; Peter Meeting</h3>
<h4 id="some-comments-on-neyman-pearson-and-approaches">Some comments on Neyman Pearson and approaches</h4>
<p>&gt; In the phylogenetics world, Huelsenbeck has a paper doing this: &quot; A Likelihood Ratio Test to Detect Conflicting Phylogenetic Signal&quot; and there’s a good introduction to the paper.</p>
<p>This is great, nice to know there’s a basis for it.</p>
<p>&gt; I see that in the paper John references, &quot; Statistical tests of models of DNA substitution “, they call what you’re doing”Monte Carlo“, and refers to some sort of resampling-the-data equivalent as the bootstrap. The references in that paper are useful: Riplay ’87 and Cox ’61 and ’62. (the first Cox paper is the one I referred to before)</p>
<p>Yes, it seems a lot of the literature assumes bootstrap means non-parametric bootstrap, and there also seems some bias against the word, so Monte Carlo might be more useful, if less precise, than calling it parametric bootstrap.</p>
<p><br /> &gt; There’s also some literature on mixture models, for instance, in “On Bootstrapping the Likelihood Ratio Test Stastistic for the Number of Components in a Normal Mixture”:</p>
<p>&gt; &quot; In many situations in practice, for example in cluster analysis where g is the number of components correspond the number of non-overlapping clusters to be produced for the to data, there is no a priori knowledge of g. An obvious way of approaching this problem is to use the likelihood ratio test statistic to test for the smallest value of g compatible with the data. Unfortunately with mixture models, it is well known that regularity conditions do not hold for -2 log A to have its usual asymptotic null distribution of chi-squared with degrees of freedom equal to the difference between the number of parameters under the null and alternative hypotheses. In the context of latent class models, Aitkin, Anderson and Hinde (1981) assessed the null distribution -2 log A using a resampling of method which can be viewed as a particular application of the general bootstrap approach of Efron (1979, 1982). The assessment made is on the basis of a number, say K, of bootstrap replications of -2 log A obtained by appropriate of resampling. More recently, Aitkin and Rubin (1985) adopted an approach which places a prior distribution on the vector of mixing proportions over which the likelihood is integrated before the evaluation of -2 log A. &quot;</p>
<p>&gt; However, they do things somewhat differently: they re-estimate their parameters for each bootstrapped replicate, and take the likelihood ratio with the resulting parameters.</p>
<p>This is in fact what I am doing. This makes more sense to me since it treats the simulated data. I should make sure to be more explicit in the paper.</p>
<p>&gt; Hm, and crucially, here’s a section from Goldman “…DNA substitution” “It is crucially important that these likelihoods be maximized independently for each i (i.e., \alpha and \beta must be estimated separately for each x_i) when performing the Monte Carlo simulation, and not simply calculated under the assumption that \hat \alpha and \hat \beta as estimated from the original data; equation (9b)] are correct.”</p>
<p>&gt; They refer to Hall and Wilson as saying that not doing this: e.g. not re-estimating the parameters each time, dramatically reduces the power. That paper looks like a good one. Although it says it’s about “nonparametric” bootstrapping; I would have thought this was parametric bootstrapping.</p>
<p>Right, I have tried both and have found the same thing. Great to have the references to justify it. I’m with you on parametric/non-parametric, though all the non-parametric Bayesians use “non-parametric” in the same sense, as the number of parameters varies with the richness of the data, rather than being predefined.</p>
<p>&gt; <a href="https://www.bibsonomy.org/user/peter.ralph/bootstrapAll" title="https://www.bibsonomy.org/user/peter.ralph/bootstrapAll">these papers</a></p>
<p><br /> #### some more comments</p>
<p>-So, Butler and King choose your OU.3 out of their five models? And where do you end up? There is a bit of resolution lacking, here.</p>
<p><br /> -Do you check to see if the empirical likelihood distributions are relatively stable? (e.g. simulating more isn’t changing them much)</p>
<p><br /> -We really ought to find this talked about in the statistical literature. The test of the sort we are talking about is proposed in Cox, “Tests of Separate Families of Hypotheses”, <a href="https://projecteuclid.org/euclid.bsmsp/1200512162" title="https://projecteuclid.org/euclid.bsmsp/1200512162">https://projecteuclid.org/euclid.bsmsp/1200512162</a> equation (48). Except this does not involve bootstrapping; this has probably been dealt with in the literature. They seem to do this in high-energy physics: <a href="https://www.springerlink.com/content/q02303062221314n/" title="https://www.springerlink.com/content/q02303062221314n/">https://www.springerlink.com/content/q02303062221314n/</a></p>
<p><br /> . 2: “correlation typically strongest under a BM model” — really?</p>
<p>. 4: Not clear why if “The sample points are then statistically independent and the method of phylogenetically independent contrasts will be positively misleading.”</p>
<p>in general: the processes generally only “reach” the stationary distribution colloquially – to be correct, they “approach” it.</p>
<p>. 4: For example 1(c), it seems like the two models (correlation due to phylogeny or due to selection towards different optima) may not actually be separable, at least if the branches are long as you imply. (oh, you talk about this on p. 5 ?)</p>
<p>top of p. 5: For an OU model one can do independent contrasts also, is this not done?</p>
<p>top of p. 6: The reasoning for “Insufficient data” isn’t so good.</p>
<p>. 6: “Because the BM model does not have a stationary distribution, correlations established during shared history along a phylogeny are never erased…” – Actually, the correlation still approaches zero as the length of the terminal nodes grows: this approaches the star-tree, for which the tips are independent.</p>
<p>. 7: “dividing the size data into two groups by maximum likelihood” – dividing by ML how?</p>
<p>. 8, Figure 3: It seems that in Figure 3, each model’s distribution of AIC score is computed under itself? That is, the red curve were the AIC scores of observations got by simulating under the red model? If so, then the figure does not say that OU.2 outperforms the others. It says that AIC isn’t correctly penalizing, because if it was, all of those curves would be centered in the same place. (right? that’s the point of the penalization?) It would be better, if indeed you aren’t already, to simulate under one model and draw those curves.</p>
<p>. 9: “most powerful test” means something specific; it shouldn’t be followed by “of the probability of falsely accepting the null hypothesis”.</p>
<p>. 9: Do you have a citation for the likelihood ratio failing in the case of a boundary value?</p>
<p>. 10: did you actually implement the bootstrap corrections of Efron et al?</p>
<p>. 10: I think a better word than “confirm” could be used. Or at least some discussion.</p>
<p>. 11: Discussion about OU.2 vs OU.3 – P=.06 isn’t all that small, considering the multiple testing going on? Some more discussion is called for.</p>
<p>. 12 and elsewhere: Probably should avoid “robust” without specifying robust to what, since it means something specific.</p>
<p>Fig 7: Why don’t you show the corresponding plot for OU.3 vs OU.*?</p>
<h4 id="more-comments-by-hand-on-manuscript-printout">More comments by hand on manuscript printout</h4>
<h2 id="power-in-trees-direct-test">Power in Trees direct test</h2>
<ul>
<li><p>Implementing a direct test of power in trees, see <a href="https://github.com/cboettig/Comparative-Phylogenetics/blob/dab536f6c70a0bd47847bb088c4277c4b439c5e7/R/powertest.R" title="https://github.com/cboettig/Comparative-Phylogenetics/blob/dab536f6c70a0bd47847bb088c4277c4b439c5e7/R/powertest.R">powertest.R</a> in Comparative-Phylogenetics. Approach simulates data on the tree at progressively higher values of alpha, and uses the Monte Carlo likelihood ratio test to decide the minimum alpha that can be detected relative to the length of the tree. Requires a single likelihood ratio bootstrap on each value of alpha to be tested.</p></li>
<li><p>Added support for my older traitmodels function, which I’ve resurrected as a branch from the wrightscape library. located in ~/Documents/experimental/wrightscape-clone/wrightscape/R and is on a branch called single_peak_ou</p></li>
</ul>
<p><br /> - Fits of OU are a subset of BM, so in principle should always outperform the likelihood of BM. Numerics struggle to converge in some cases giving wildly poor likelihoods though.</p>
<ul>
<li>parallelization is giving strange errors</li>
</ul>
<!-- -->

<pre><code> Error in checkForRemoteErrors(val) : 
 one node produced an error: Starting of snow cluster failed! Error in socketConnection(port = port, server = TRUE, blocking = TRUE,   
 cannot open the connection</code></pre>
<p>–Carl Boettiger 02:45, 26 August 2010 (EDT) Fixed by removing the snowfall parallelization in the LR_boot function.</p>
<h4 id="primates-example">primates Example</h4>
<p>using the trivial 5-taxa primate tree often used in ape package examples, minimum alpha exceeds all values tested (&gt;2000). As expected.</p>
<h4 id="anoles-example">Anoles Example</h4>
<pre class="de1"><code>&gt; out2 &lt;- treepower(tree, nboot=100, cpu=1, alpha=alpha )
 
$min_alpha
[1] 6
 
$p
 [1] 0.27 0.86 0.65 0.21 0.17 0.98 0.16 0.69 0.39 0.93 0.97 0.97 1.00 1.00 0.94
[16] 1.00 0.99 1.00 0.99 1.00 1.00 1.00 1.00</code></pre>
<p><br /> #### Labrids Example</p>
<p>appears to be somewhere around 1.</p>
<p><br /> #### Geospiza Example</p>
<pre class="de1"><code>&gt; birds2 &lt;- treepower(ape2ouch(geospiza$geospiza.tree), nboot=100, cpu=1, alpha=alpha)
&gt; birds2$p
 [1] 0.80 0.61 0.17 0.71 0.33 0.72 0.61 0.69 0.80 0.35 0.99 0.78 0.94 1.00 0.94
[16] 0.93 0.72 0.88 0.98 1.00 1.00 0.96 0.97
&gt; alpha
 [1]  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1.0  2.0  3.0  4.0  5.0  6.0
[16]  7.0  8.0  9.0 10.0 20.0 30.0 40.0 50.0
minimum detectable alpha is 9
 
&gt; #fewer replicates, varied outcome
&gt; out &lt;- treepower(tree, nboot=40, cpu=1, alpha=alpha )
&gt; out$p
 [1] 0.375 0.775 0.675 0.525 0.500 0.725 0.950 0.950 1.000 0.575 0.775 1.000
[13] 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000
minimum detectable alpha is 2</code></pre>
<p><br /> #### Running additional examples overnight =</p>
<p><br /></p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:https://ogp.me/ns/article#">
  <p> <i class="icon-calendar"></i>
    <time datetime="2010-08-25 00:00:00 +0000" 
    property="dc:created">25 Aug 2010</time></p>
   

 <br />

  
	<p><a class="btn btn-default" rel="prev" href='/2012/08/19/Writing.html'><i class="icon-chevron-left"></i> prev</a>
  
  
  <a class="btn btn-default" rel="next" href='/2012/08/26/Likelihood-Ratio-Paper--Power-in-Trees.html'>next <i class="icon-chevron-right"></i></a></p>
  

  <br />

  <p> <a  onclick="recordOutboundLink(this, 'Outbound Links', 'history'); 
            return false;" 
          class="btn btn-default" 
          href="https://github.com/cboettig/2012/commits/master/_posts/2010-08-25-Likelihood-Ratio-Manuscript.md"><i class="icon-time"></i> history</a></p>

  <br />

  <p><i class="icon-list"></i> Posted in 
     
      <a rel="dc:subject" class="category" 
         href="/2012/categories.html#evolution">evolution</a>
    
    </p>

  <p> <i class="icon-tag"></i> tags: 
    </p>

  <br/>

  

  <br/>
  <p><small> <i class="icon-barcode"></i> SHA Hash: <a href="https://github.com/cboettig/2012/commit/dbb400936cc5bebbbfa5193f4db11ff4149eee67/_posts/2010-08-25-Likelihood-Ratio-Manuscript.md"> dbb400936cc5bebbbfa5193f4db11ff4149eee67</a></small></p>
    
  <br/>
  

</aside>

    </div>
  </div>
</div>

      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="col-md-8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>






      <footer class="footer">

<!--************** FOAF information to social networks ***************************** -->
  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://www.carlboettiger.info#me">
      <p>
          <script type="text/javascript" src="/assets/js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
      <!--
          <a rel="foaf:account" href="https://plus.google.com/" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); 
             return false;"><i class="fa fa-google-plus"></i></a>

          <a rel="foaf:account" href="https://www.mendeley.com/profiles/carl-boettiger" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); 
             return false;"><img src="/assets/img/icon-mendeley.png" /></a> 

           citations on google-scholar

           stackoverflow
      -->
      <a rel="foaf:weblog" type="application/atom+xml" href="/blog.xml"  
         class="showtooltip" title="RSS feeds for my blog-style entries. See the feed on my lab notebook (/atom.xml) to follow all entries instead." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    <!--**************** End social links **************************** -->


    <div class="col-md-4 col-md-offset-1 col-xs-4">
      <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="https://onsclaims.wikispaces.com/"><img src="/assets/img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="https://creativecommons.org/ns#license" href="https://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="/assets/img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>


  
<!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
  <span
      class="Z3988" 
      title="ctx_ver=Z39.88-2004
      &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
      &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
      &amp;rft.title=Likelihood Ratio Manuscript
      &amp;rft.creator=Carl Boettiger
      &amp;rft.date=2010-08-25
      &amp;rft.language=EN
      &amp;rft.rights=CC0
      &amp;rft_id=https://www.carlboettiger.info/08/25/Likelihood-Ratio-Manuscript.html">
  </span>


</footer>




          <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <!-- JQuery, used on a few pages (still?) -->
    <!-- <script type="text/javascript" src="/assets/js/jquery.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <!--  <script src="/assets/js/bootstrap.min.js"></script> -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>


    

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>




    </div>
  </body>
</html>
   
